################################################
# Author: ditekSHen
# Reference: https://github.com/ditekshen/detection
# ##############################################
#
################################################
# INDICATOR DOCUMENTS
################################################
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-DOCUMENT Ancalog RTF exploit builder document detected"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:"|5C|*|5C|ancalog"; nocase; fast_pattern:only; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_RTF_Ancalog_Exploit_Builder_Document, clamav INDICATOR.RTF.AncalogExploitBuilderDocument; classtype:trojan-activity; sid:910000; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-DOCUMENT Ancalog RTF exploit builder document detected"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:"|5C|*|5C|ancalog"; nocase; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Ancalog_Exploit_Builder_Document, clamav INDICATOR.RTF.AncalogExploitBuilderDocument; classtype:trojan-activity; sid:910001; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATE-DOCUMENT RTF document with Equation and BITSAdmin download attempt"; flow:to_client,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"6269747361646d696e"; nocase; metadata:ruleset community, service http, service imap, service pop3, service ftp-data, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910002; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATE-DOCUMENT RTF document with Equation and BITSAdmin download attempt"; flow:to_server,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"6269747361646d696e"; nocase; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910003; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATE-DOCUMENT RTF document with Equation and PowerShell download attempt"; flow:to_client,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"706f7765727368656c6c"; nocase; metadata:ruleset community, service http, service imap, service pop3, service ftp-data, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910004; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATE-DOCUMENT RTF document with Equation and PowerShell download attempt"; flow:to_server,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"706f7765727368656c6c"; nocase; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910005; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATE-DOCUMENT RTF document with Equation and CertUtil download attempt"; flow:to_client,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"636572747574696c"; nocase; metadata:ruleset community, service http, service imap, service pop3, service ftp-data, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910006; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATE-DOCUMENT RTF document with Equation and CertUtil download attempt"; flow:to_server,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; nocase; content:"636572747574696c"; nocase; metadata:ruleset community, service smtp, yara INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav INDICATOR.RTF.EquationBITSAdminDownloader; classtype:trojan-activity; sid:910007; rev:1;)
################################################
# MALWARE
################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RevengeRAT information outbound connection"; flow:to_server,established; content:"InformationRevenge-RAT"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_RevengeRAT, clamav MALWARE.Win.RevengeRAT; classtype:trojan-activity; sid:920000; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RevengeRAT keep alive outbound connection"; flow:to_server,established; content:"keepAlivePing!!@#%"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_RevengeRAT, clamav MALWARE.Win.RevengeRAT; classtype:trojan-activity; sid:920001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.RevengeRAT PNC outbound connection"; flow:to_server,established; content:"PNC!@#%"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_RevengeRAT, clamav MALWARE.Win.RevengeRAT; classtype:trojan-activity; sid:920002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"400|7C|root|7C|"; fast_pattern:only; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920003; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; dsize:10; content:"|7C|root|7C|"; offset:3; depth:6; fast_pattern; isdataat:!1,relative; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920004; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"|7C|root|7C|"; within:9; fast_pattern; pcre:"/\d{1,3}\x7croot\x7c\d/"; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920005; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.XpertRAT inbound connection"; flow:to_client,established; dsize:<12; content:"400|7C|0|7C|"; content:"@#@!"; distance:1; metadata:ruleset community, yara MALWARE_Win_XpertRAT, clamav MALWARE.Win.XpertRAT; classtype:trojan-activity; sid:920006; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Agent downloader outbound connection"; flow:to_server,established; content:"User-Agent: Mozilla/5.0 Gecko/41.0 Firefox/41.0|0D 0A|"; fast_pattern:only; http_header; content:"/?v="; http_uri; content:"&g="; http_uri; metadata:ruleset community, yara MALWARE_Win_DA1, clamav MALWARE.Win.DA1; classtype:trojan-activity; sid:920007; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.VSSDestroy/Matrix variant post-infection outbound connection"; flow:to_server,established; content:"/addrecord.php"; fast_pattern:only; http_uri; content:"apikey="; http_uri; content:"&compuser="; http_uri; content:"&sid="; http_uri; content:"&phase="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_VSSDestroy, clamav MALWARE.Win.VSSDestroy; classtype:trojan-activity; sid:920008; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.VSSDestroy/Matrix variant post-infection outbound connection"; flow:to_server,established; content:"/addrec.php"; fast_pattern:only; http_uri; content:"apikey="; http_uri; content:"&compuser="; http_uri; content:"&sid="; http_uri; content:"&phase="; http_uri; metadata:ruleset community, service http, yara MALWARE_Win_VSSDestroy, clamav MALWARE.Win.VSSDestroy; classtype:trojan-activity; sid:920009; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.WSHRAT variant outbound connection"; flow:to_server,established; content:"User-Agent: WSHRAT"; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_WSHRAT, clamav MALWARE.Win.WSHRAT; classtype:trojan-activity; sid:920010; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.WSHRAT variant outbound connection"; flow:to_server,established; content:"user-agent:: <|7C|>"; fast_pattern:only; metadata:ruleset community, service http, yara MALWARE_Win_WSHRAT, clamav MALWARE.Win.WSHRAT; classtype:trojan-activity; sid:920011; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"MALWARE-CNC Win.Trojan.WSHRAT variant second stage outbound connection"; content: "GET"; http_method; content:"/open-keylogger HTTP/1."; within:23; metadata:ruleset community, service http, yara MALWARE_Win_WSHRAT, clamav MALWARE.Win.WSHRAT; classtype:trojan-activity; sid:920012; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"encoder:"; http_header; content:"shellchcp:"; http_header; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920013; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"errdesc:"; http_header; content:"errno:"; http_header; content:"errname:"; http_header; content:"Referer:"; http_header; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920014; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C download payload outbound connection"; flow:to_server,established; content:"X-UploadFileJob:"; fast_pattern:only; http_header; content:"Referer:"; http_header; pcre:"/X-UploadFileJob:\s(true|false)\x0d\x0a/H"; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920015; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"./mshtml,RunHTMLApplication"; fast_pattern:only; http_uri; content:"/html?"; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920016; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; content:"=stage|3B|"; http_uri; content:"/html?"; http_uri; content:"Referer:"; http_header; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920017; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Koadic framework Windows host information exfiltration"; flow:to_server,established; content:"~~~Windows"; http_client_body; content:"~~~AMD"; distance:0; http_client_body; content:"~~~C:|5C|Users"; distance:0; http_client_body; metadata:ruleset community, service http, yara MALWARE_DOC_KoadicDOC, yara MALWARE_BAT_KoadicBAT, yara MALWARE_JS_KoadicJS, clamav MALWARE.DOC.KoadicDOC, clamav MALWARE.BAT.KoadicBAT, clamav MALWARE.JS.KoadicJS; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920018; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound HTTP connection"; flow:to_server,established; content:"token="; http_client_body; content:"&name="; http_client_body; content:"&type="; http_client_body; content:"&data="; http_client_body; content:!"User-Agent"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920019; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Execution"; flow:to_server,established; content:"Subject: Execution Alert!"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920020; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Password"; flow:to_server,established; content:"Subject: Password Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920021; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Keystroke"; flow:to_server,established; content:"Subject: KeyStroke Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920022; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Screen"; flow:to_server,established; content:"Subject: Screen Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920023; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Webcam"; flow:to_server,established; content:"Subject: WebCam Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920024; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Clipboard"; flow:to_server,established; content:"Subject: Clipboard Monitoring"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920025; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection"; flow:to_server,established; content:"U3RlYWxlciBMb2dz"; fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp, yara MALWARE_Win_M00nD3v, clamav MALWARE.Win.M00nD3v; classtype:trojan-activity; sid:920026; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"PSWD |7C| Client Name:"; within:50; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920027; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"Keylogger - Passwords -------|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920028; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"|3B| name=|22|PXRecoveries |7C|"; fast_pattern; content:".txt"; within:30; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920029; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"IP:"; content:"Owner Name:"; content:"OS Name:"; content:"Platform:"; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920030; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: PSWD|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920031; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Logs|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920032; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Screenshot|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Phoenix, clamav MALWARE.Win.Phoenix; classtype:trojan-activity; sid:920033; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"- Passwords Logs -"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920034; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"- Keyboard Logs -"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920035; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: Logger - Server Ran"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920036; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: Logger|7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920037; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"SGF3a0V5ZSBSZ"; fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920038; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"SGF3a0V5ZSBLZXlsb"; fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920039; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: HawkEye Keylogger"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920040; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: HawkEye Reborn"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920041; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STOR HawkEyeReborn"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920042; rev:1;)
alert tcp $HOME_NET any -> $SMTP_SERVERS 21 (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STORHawkEye"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920043; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STOR HawkEyeKeylogger"; depth:21; fast_pattern; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920044; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.HawkEye outbound HTTP connection"; flow:to_server,established; content:"Secret="; http_client_body; content:"HWID="; nocase; fast_pattern:only; http_client_body; content:"Name="; nocase; content:"OS="; nocase; http_client_body; content:"Type="; http_client_body; content:!"User-Agent"; http_header; metadata:ruleset community, service http, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920045; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AspireLogger outbound SMTP connection"; flow:to_server,established; content:"Subject: AspireLogger ["; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Aspire, clamav MALWARE.Win.Aspire; classtype:trojan-activity; sid:920046; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AspireLogger outbound SMTP connection"; flow:to_server,established; content:"PC:"; content:"IP:"; within:88; content:"Aspire"; metadata:ruleset community, service smtp, yara MALWARE_Win_Aspire, clamav MALWARE.Win.Aspire; classtype:trojan-activity; sid:920047; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Orion keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Orion Logger"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_Orion, clamav MALWARE.Win.Orion; classtype:trojan-activity; sid:920048; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Orion keylogger outbound SMTP connection"; flow:to_server,established; content:"System Details |7C|=3D="; content:"=0D=0AComputer Name:"; content:"=0D=0ACountry Name:"; metadata:ruleset community, service smtp, yara MALWARE_Win_Orion, clamav MALWARE.Win.Orion; classtype:trojan-activity; sid:920049; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Firebird/Hive RAT outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:": PASSWORDS"; within:150; metadata:ruleset community, service smtp, yara MALWARE_Win_FirebirdRAT, clamav MALWARE.Win.FirebirdRAT; classtype:trojan-activity; sid:920050; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"Passwords Recovered From: "; within:150; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920051; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"Screen Capture From: "; within:150; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920052; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:" Recovered Accounts"; within:150; fast_pattern; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920053; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: PW_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920054; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: CO_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920055; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: SC_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920056; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: KL_"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_AgentTeslaV2, yara MALWARE_Win_AgentTeslaV3, clamav MALWARE.Win.AgentTeslaV2, clamav MALWARE.Win.AgentTeslaV3; classtype:trojan-activity; sid:920057; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR PW_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920058; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR CO_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920059; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR SC_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920060; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR KL_"; fast_pattern:only; metadata:ruleset community, service ftp, yara MALWARE_Win_HawkEyev9, clamav MALWARE.Win.HawkEyev9; classtype:trojan-activity; sid:920061; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.MassLogger outbound SMTP connection"; flow:to_server,established; content:"Subject: MassLogger |7C|"; fast_pattern:only; metadata:ruleset community, service smtp, yara MALWARE_Win_MassLogger, clamav MALWARE.Win.MassLogger; classtype:trojan-activity; sid:920062; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Generic keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content: "Screen Capture"; within:150; metadata:ruleset community, service smtp; classtype:trojan-activity; sid:920063; rev:1;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"MALWARE-CNC Win.Trojan.Generic keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content: "Keylog"; within:150; metadata:ruleset community, service smtp; classtype:trojan-activity; sid:920064; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MALWARE-CNC Doc.Trojan.ReconDoc outbound connection"; flow:to_server,established; content:".php?id="; http_uri; base64_decode:relative; base64_data; content:"document_name:"; content:"|7C|computer_name:"; content:"|7C|user_name:"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920065; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.QuasarRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"Quasar Server CA"; distance:1; fast_pattern; metadata:ruleset community, service ssl, yara MALWARE_Win_QuasarRAT; classtype:trojan-activity; sid:920066; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.AsyncRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"AsyncRAT Server"; distance:1; fast_pattern; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920067; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"MALWARE-CNC Win.Trojan.Orcus RAT inbound SSL certificate"; flow:to_client,established; content:"|16 03 01|"; content:"|02|"; distance:2; content:"|03 01|"; distance:3; content:"Orcus Server"; fast_pattern; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920068; rev:1;)
################################################
# INDICATOR PACKED
################################################
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Spices.Net packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"protected by 9Rays.Net Spices.Net Obfuscator"; fast_pattern:only; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_EXE_Packed_Spices; classtype:policy-violation; sid:930001; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Spices.Net packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by 9Rays.Net Spices.Net Obfuscator"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Spices; classtype:policy-violation; sid:930002; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Spices.Net packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by 9Rays.Net Spices.Net Obfuscator"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Spices; classtype:policy-violation; sid:930003; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED PS2EXE packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"PS2EXE"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_PS2EXE; classtype:policy-violation; sid:930004; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED PS2EXE packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"PS2EXE"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_PS2EXE; classtype:policy-violation; sid:930005; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED PS2EXE packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"PS2EXE"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_PS2EXE; classtype:policy-violation; sid:930006; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ASPACK packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|2E 61 73 70 61 63 6B 00 00|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ASPack; classtype:policy-violation; sid:930007; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ASPACK packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 61 73 70 61 63 6B 00 00|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ASPack; classtype:policy-violation; sid:930008; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ASPACK packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 61 73 70 61 63 6B 00 00|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ASPack; classtype:policy-violation; sid:930009; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Titan packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|2E 74 69 74 61 6E 00 00|"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Titan; classtype:policy-violation; sid:930010; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Titan packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 74 69 74 61 6E 00 00|"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Titan; classtype:policy-violation; sid:930011; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Titan packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|2E 74 69 74 61 6E 00 00|"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Titan; classtype:policy-violation; sid:930012; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED AspireCrypt packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"protected by AspireCrypt"; fast_pattern:only; metadata:ruleset community, service ftp-data, service http, service imap, service pop3, yara INDICATOR_EXE_Packed_AspireCrypt; classtype:policy-violation; sid:930013; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED AspireCrypt packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by AspireCrypt"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_AspireCrypt; classtype:policy-violation; sid:930014; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED AspireCrypt packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"protected by AspireCrypt"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_AspireCrypt; classtype:policy-violation; sid:930015; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|ConfusedByAttribute|00|"; fast_pattern:only; content:"ConfuserEx v"; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserEx; classtype:policy-violation; sid:930016; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|00|ConfusedByAttribute|00|"; fast_pattern:only; content:"ConfuserEx v"; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserEx; classtype:policy-violation; sid:930017; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|ConfusedByAttribute|00|"; fast_pattern:only; content:"ConfuserEx v"; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserEx; classtype:policy-violation; sid:930018; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds Protector"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930019; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Beds Protector"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930020; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930021; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930022; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930023; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Beds-Protector"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector; classtype:policy-violation; sid:930024; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"TrinityProtector"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930025; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"TrinityProtector"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930026; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Trinity0-protecor"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930027; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Trinity0-protecor"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930028; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Trinity0-protecor"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930029; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"TrinityProtectorr"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_ConfuserExMod_Trinity; classtype:policy-violation; sid:930030; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED MPRESS packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".MPRESS"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_MPress; classtype:policy-violation; sid:930031; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED MPRESS packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".MPRESS"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_MPress; classtype:policy-violation; sid:930032; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED MPRESS packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".MPRESS"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_MPress; classtype:policy-violation; sid:930033; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Nate packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".nate"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Nate; classtype:policy-violation; sid:930034; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Nate packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".nate"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Nate; classtype:policy-violation; sid:930035; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Nate packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".nate"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Nate; classtype:policy-violation; sid:930036; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".bxpck"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930037; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".bxpck"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930038; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"BoxedAppSDK_HookFunction"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930039; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"BoxedAppSDK_HookFunction"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930040; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".bxpck"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930041; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED BoxedApp packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"BoxedAppSDK_HookFunction"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_BoxedApp; classtype:policy-violation; sid:930042; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".ex_cod"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930043; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".ex_cod"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930044; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"eXPressor_InstanceChecker_"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930045; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"eXPressor_InstanceChecker_"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930046; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".ex_cod"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930047; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED eXPressor packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"eXPressor_InstanceChecker_"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_eXPressor; classtype:policy-violation; sid:930048; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED VMProtect packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".vmp"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_VMProtect; classtype:policy-violation; sid:930049; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED VMProtect packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".vmp"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_VMProtect; classtype:policy-violation; sid:930050; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED VMProtect packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".vmp"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_VMProtect; classtype:policy-violation; sid:930051; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED Engima packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".enigma"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_Enigma; classtype:policy-violation; sid:930052; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED Engima packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:".enigma"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_Enigma; classtype:policy-violation; sid:930053; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED Engima packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:".enigma"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_Enigma; classtype:policy-violation; sid:930054; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED LibZ packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|LibZInitializer"; fast_pattern:only; content:"|00|LibZ.Injected|00|"; distance:0; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_LibZ; classtype:policy-violation; sid:930055; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED LibZ packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|00|LibZInitializer"; fast_pattern:only; content:"|00|LibZ.Injected|00|"; distance:0; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_LibZ; classtype:policy-violation; sid:930056; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED LibZ packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|00|LibZInitializer"; fast_pattern:only; content:"|00|LibZ.Injected|00|"; distance:0; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_LibZ; classtype:policy-violation; sid:930057; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED LSD packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"the LSD executable packer"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_EXE_Packed_LSD; classtype:policy-violation; sid:930058; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED LSD packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"the LSD executable packer"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_EXE_Packed_LSD; classtype:policy-violation; sid:930059; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED LSD packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"the LSD executable packer"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_EXE_Packed_LSD; classtype:policy-violation; sid:930060; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-PACKED EXE2MSI-free packed executable file transfer over SMTP detected"; flow:to_server,established; flowbits:isset,file.ole|file.msi; file_data; content:"Exe to msi converter free"; fast_pattern:only; metadata:ruleset community, service smtp, yara INDICATOR_MSI_EXE2MSI; classtype:policy-violation; sid:930061; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-PACKED EXE2MSI-free packed executable file transfer over HTTP detected"; flow:to_client,established; flowbits:isset,file.ole|file.msi; file_data; content:"Exe to msi converter free"; fast_pattern:only; metadata:ruleset community, service http, yara INDICATOR_MSI_EXE2MSI; classtype:policy-violation; sid:930062; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"INDICATOR-PACKED EXE2MSI-free packed executable file transfer over SMB detected"; flow:to_server,established; flowbits:isset,file.ole|file.msi; file_data; content:"Exe to msi converter free"; fast_pattern:only; metadata:ruleset community, service netbios-ssn, yara INDICATOR_MSI_EXE2MSI; classtype:policy-violation; sid:930063; rev:1;)
################################################
# INDICATOR SUSPICIOUS
################################################
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-OBFUSCATION Spoofed Host header"; flow:to_server,established; content:"Host: 127.0.0.1|0D 0A|"; http_header; fast_pattern:only; metadata:ruleset community, service http; classtype:misc-activity; sid:940060; rev:1;)