################################################
# Author: ditekSHen
# Reference: https://github.com/ditekshen/detection
# ##############################################
#
################################################
# INDICATOR DOCUMENTS
################################################
alert file ( msg:"INDICATOR-DOCUMENT Ancalog RTF exploit builder document detected"; file_type:"RTF"; file_data; content:"|5C|*|5C|ancalog",fast_pattern,nocase; service:http, smtp; rem:"yara:INDICATOR_RTF_Ancalog_Exploit_Builder_Document, clamav:INDICATOR.RTF.AncalogExploitBuilderDocument, tlp:white "; sid:910000; rev:1; )
alert file ( msg:"INDICATOR-DOCUMENT Exploit RTF document Equation-BITSAdmin downloader detected"; file_type:"RTF"; file_data; file_data; content:"0200000002ce020000000000c000000000000046",fast_pattern,nocase; content:"6269747361646d696e",nocase; service:http, smtp; rem:"yara:INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav:INDICATOR.RTF.EquationBITSAdminDownloader, tlp:white "; sid:910001; rev:1; )
################################################
# MALWARE
################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RevengeRAT information outbound connection"; flow:to_server,established; content:"InformationRevenge-RAT",fast_pattern; rem:"yara:MALWARE_Win_RevengeRAT, clamav:MALWARE.Win.RevengeRAT"; classtype:trojan-activity; sid:920000; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RevengeRAT keep alive outbound connection"; flow:to_server,established; content:"keepAlivePing!!@#%",fast_pattern; rem:"yara:MALWARE_Win_RevengeRAT, clamav:MALWARE.Win.RevengeRAT"; classtype:trojan-activity; sid:920001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RevengeRAT PNC outbound connection"; flow:to_server,established; content:"PNC!@#%",fast_pattern; rem:"yara:MALWARE_Win_RevengeRAT, clamav:MALWARE.Win.RevengeRAT"; classtype:trojan-activity; sid:920002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"400|7C|root|7C|",fast_pattern; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920003; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; dsize:10; content:"|7C|root|7C|",offset 3,depth 6,fast_pattern; isdataat:!1,relative; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920004; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"|7C|root|7C|",within 9,fast_pattern; pcre:"/\d{1,3}\x7croot\x7c\d/"; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920005; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT inbound connection"; flow:to_client,established; dsize:<12; content:"400|7C|0|7C|"; content:"@#@!",distance 1; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920006; rev:1; )
